{"version":3,"file":"app.js","sources":["App.vue","main.js"],"sourcesContent":["<template>\r\n  <page-meta :page-style=\"pageStyle\" />\r\n  <view class=\"app-container\" :class=\"themeClass\" :style=\"themeVariables\">\r\n    <slot />\r\n  </view>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { computed, onUnmounted, watch } from 'vue';\r\nimport { onLaunch } from '@dcloudio/uni-app';\r\nimport { storeToRefs } from 'pinia';\r\nimport { useAppStore } from '@/stores/app';\r\nimport type { ThemePreference } from '@/utils/storage';\r\n\r\ninterface ThemePreset {\r\n  pageBackground: string;\r\n  textColor: string;\r\n  backgroundColor: string;\r\n  navigationBar: {\r\n    background: string;\r\n    frontColor: '#ffffff' | '#000000';\r\n  };\r\n  variables: Record<string, string>;\r\n}\r\n\r\nconst themePresets: Record<ThemePreference, ThemePreset> = {\r\n  dark: {\r\n    pageBackground:\r\n      'radial-gradient(circle at top, rgba(56, 189, 248, 0.18), transparent 65%), radial-gradient(circle at bottom, rgba(99, 102, 241, 0.15), transparent 60%), #05070f',\r\n    textColor: 'rgba(226, 232, 240, 0.78)',\r\n    backgroundColor: '#05070f',\r\n    navigationBar: {\r\n      background: '#05070f',\r\n      frontColor: '#ffffff'\r\n    },\r\n    variables: {\r\n      '--app-background':\r\n        'radial-gradient(circle at top, rgba(56, 189, 248, 0.18), transparent 65%), radial-gradient(circle at bottom, rgba(99, 102, 241, 0.15), transparent 60%), #05070f',\r\n      '--card-background': 'rgba(15, 23, 42, 0.72)',\r\n      '--card-border': 'rgba(108, 92, 231, 0.25)',\r\n      '--surface-light': 'rgba(12, 19, 33, 0.55)',\r\n      '--text-primary': '#f8fafc',\r\n      '--text-secondary': 'rgba(226, 232, 240, 0.78)',\r\n      '--text-muted': 'rgba(148, 163, 184, 0.75)',\r\n      '--outline-color': 'rgba(148, 163, 184, 0.24)',\r\n      '--danger-color': '#f87171',\r\n      '--accent-gradient': 'linear-gradient(135deg, rgba(56, 189, 248, 0.85), rgba(99, 102, 241, 0.85))',\r\n      '--color-primary': '#6c5ce7',\r\n      '--color-secondary': '#00f0ff',\r\n      '--color-dark': '#0b1220',\r\n      '--color-darker': '#0a0f1a'\r\n    }\r\n  },\r\n  light: {\r\n    pageBackground: 'linear-gradient(180deg, #f7f9fc, #e0ecff)',\r\n    textColor: '#4b5563',\r\n    backgroundColor: '#f7f9fc',\r\n    navigationBar: {\r\n      background: '#f7f9fc',\r\n      frontColor: '#000000'\r\n    },\r\n    variables: {\r\n      '--app-background': 'linear-gradient(180deg, #f7f9fc, #e0ecff)',\r\n      '--card-background': 'rgba(255, 255, 255, 0.86)',\r\n      '--card-border': 'rgba(148, 163, 184, 0.35)',\r\n      '--surface-light': 'rgba(255, 255, 255, 0.9)',\r\n      '--text-primary': '#1f2937',\r\n      '--text-secondary': '#4b5563',\r\n      '--text-muted': '#6b7280',\r\n      '--outline-color': 'rgba(148, 163, 184, 0.45)',\r\n      '--danger-color': '#dc2626',\r\n      '--accent-gradient': 'linear-gradient(135deg, rgba(59, 130, 246, 0.9), rgba(14, 165, 233, 0.9))',\r\n      '--color-primary': '#6c5ce7',\r\n      '--color-secondary': '#0ea5e9',\r\n      '--color-dark': '#0b1220',\r\n      '--color-darker': '#0a0f1a'\r\n    }\r\n  },\r\n  cartoon: {\r\n    pageBackground:\r\n      'radial-gradient(circle at top left, #ffe08a, transparent 55%), radial-gradient(circle at bottom right, #8ec5fc, transparent 55%), #ffe6f7',\r\n    textColor: '#5b4b8a',\r\n    backgroundColor: '#ffe6f7',\r\n    navigationBar: {\r\n      background: '#ffe6f7',\r\n      frontColor: '#000000'\r\n    },\r\n    variables: {\r\n      '--app-background':\r\n        'radial-gradient(circle at top left, #ffe08a, transparent 55%), radial-gradient(circle at bottom right, #8ec5fc, transparent 55%), #ffe6f7',\r\n      '--card-background': 'rgba(255, 255, 255, 0.92)',\r\n      '--card-border': 'rgba(255, 182, 193, 0.6)',\r\n      '--surface-light': 'rgba(255, 255, 255, 0.95)',\r\n      '--text-primary': '#1f1f3d',\r\n      '--text-secondary': '#5b4b8a',\r\n      '--text-muted': '#746292',\r\n      '--outline-color': 'rgba(255, 182, 193, 0.6)',\r\n      '--danger-color': '#f97316',\r\n      '--accent-gradient': 'linear-gradient(135deg, #ff7eb3, #65c7f7)',\r\n      '--color-primary': '#6c5ce7',\r\n      '--color-secondary': '#ff7eb3',\r\n      '--color-dark': '#0b1220',\r\n      '--color-darker': '#0a0f1a'\r\n    }\r\n  }\r\n};\r\n\r\nconst appStore = useAppStore();\r\nconst { theme } = storeToRefs(appStore);\r\nconst themeClass = computed(() => `theme-${theme.value}`);\r\nconst activePreset = computed<ThemePreset>(() => themePresets[theme.value] ?? themePresets.dark);\r\nconst platform =\r\n  typeof uni !== 'undefined' && typeof uni.getSystemInfoSync === 'function'\r\n    ? uni.getSystemInfoSync().uniPlatform\r\n    : '';\r\nconst isMpWeixin = platform === 'mp-weixin';\r\n\r\nconst themeVariables = computed<Record<string, string>>(() => {\r\n  const style: Record<string, string> = {};\r\n  Object.entries(activePreset.value.variables).forEach(([key, value]) => {\r\n    style[key] = value;\r\n  });\r\n  style.background = activePreset.value.pageBackground;\r\n  style['background-color'] = activePreset.value.backgroundColor;\r\n  style.color = activePreset.value.textColor;\r\n  return style;\r\n});\r\nconst pageStyle = computed(() => {\r\n  const declarations = [\r\n    ...Object.entries(activePreset.value.variables).map(([key, value]) => `${key}:${value}`),\r\n    `background:${activePreset.value.pageBackground}`,\r\n    `background-color:${activePreset.value.backgroundColor}`,\r\n    `color:${activePreset.value.textColor}`,\r\n    \"font-family:'Poppins','Noto Sans SC',sans-serif\"\r\n  ];\r\n  if (isMpWeixin) {\r\n    declarations.push(`--app-background:${activePreset.value.backgroundColor}`);\r\n  }\r\n  return declarations.join(';');\r\n});\r\n\r\nfunction applyThemePreset(preset: ThemePreset) {\r\n  if (!preset) {\r\n    return;\r\n  }\r\n\r\n  const doc = typeof document !== 'undefined' ? document : null;\r\n  if (doc?.documentElement) {\r\n    const rootStyle = doc.documentElement.style;\r\n    Object.entries(preset.variables).forEach(([key, value]) => {\r\n      rootStyle.setProperty(key, value);\r\n    });\r\n    rootStyle.setProperty('--app-background', preset.variables['--app-background'] ?? preset.pageBackground);\r\n    rootStyle.setProperty('--text-primary', preset.variables['--text-primary'] ?? preset.textColor);\r\n    if (doc.body) {\r\n      doc.body.style.background = preset.pageBackground;\r\n      doc.body.style.color = preset.textColor;\r\n    }\r\n  }\r\n\r\n  if (typeof uni !== 'undefined' && uni?.setBackgroundColor) {\r\n    try {\r\n      uni.setBackgroundColor({\r\n        backgroundColor: preset.backgroundColor,\r\n        backgroundColorTop: preset.backgroundColor,\r\n        backgroundColorBottom: preset.backgroundColor\r\n      });\r\n    } catch (error) {\r\n      uni.__f__('warn','at App.vue:169','设置背景颜色失败', error);\r\n    }\r\n  }\r\n\r\n  if (typeof uni !== 'undefined' && uni?.setNavigationBarColor) {\r\n    try {\r\n      uni.setNavigationBarColor({\r\n        backgroundColor: preset.navigationBar.background,\r\n        frontColor: preset.navigationBar.frontColor\r\n      });\r\n    } catch (error) {\r\n      uni.__f__('warn','at App.vue:180','设置标题栏颜色失败', error);\r\n    }\r\n  }\r\n}\r\n\r\nwatch(\r\n  activePreset,\r\n  (preset) => {\r\n    applyThemePreset(preset);\r\n  },\r\n  { immediate: true }\r\n);\r\n\r\nfunction handleUnauthorized(event?: { message?: string }) {\r\n  appStore.handleUnauthorized(event?.message);\r\n}\r\n\r\nonLaunch(() => {\r\n  uni.$on('app:unauthorized', handleUnauthorized);\r\n  appStore.bootstrap().catch((error) => {\r\n    uni.__f__('warn','at App.vue:200','初始化失败', error);\r\n  });\r\n});\r\n\r\nonUnmounted(() => {\r\n  uni.$off('app:unauthorized', handleUnauthorized);\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n@import './uni.scss';\r\n\r\n.app-container {\r\n  min-height: 100vh;\r\n  background: #05070f;\r\n  background: var(--app-background);\r\n  color: #f8fafc;\r\n  color: var(--text-primary);\r\n  transition: background 0.3s ease, color 0.3s ease;\r\n}\r\n</style>","import App from './App.vue';\r\nimport { createSSRApp } from 'vue';\r\nimport { createPinia } from 'pinia';\r\n\r\nexport function createApp() {\r\n  const app = createSSRApp(App);\r\n  const pinia = createPinia();\r\n\r\n  app.use(pinia);\r\n\r\n  return {\r\n    app,\r\n    pinia\r\n  };\r\n}\r\n"],"names":["useAppStore","storeToRefs","computed","uni","watch","onLaunch","onUnmounted","createSSRApp","App","createPinia"],"mappings":"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"}
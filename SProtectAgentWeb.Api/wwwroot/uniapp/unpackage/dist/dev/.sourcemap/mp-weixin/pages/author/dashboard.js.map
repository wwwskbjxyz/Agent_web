{"version":3,"file":"dashboard.js","sources":["pages/author/dashboard.vue","E:/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYXV0aG9yL2Rhc2hib2FyZC52dWU"],"sourcesContent":["<template>\r\n  <view class=\"page\" v-if=\"profile\">\r\n    <view class=\"top-bar\">\r\n      <text class=\"page-title\">软件管理</text>\r\n      <view class=\"top-actions\">\r\n        <button class=\"ghost\" @tap=\"handleLogout\">退出登录</button>\r\n        <button class=\"danger\" :disabled=\"platform.loading.deleteAuthor\" @tap=\"handleDeleteAccount\">\r\n          {{ platform.loading.deleteAuthor ? '注销中...' : '注销账号' }}\r\n        </button>\r\n      </view>\r\n    </view>\r\n\r\n    <scroll-view scroll-y class=\"content\">\r\n\r\n      <view class=\"glass-card section wechat-section\" v-if=\"isWeChatMiniProgram\">\r\n        <view class=\"section-header wechat-header\">\r\n          <text class=\"section-title\">微信订阅</text>\r\n          <view class=\"wechat-status-group\">\r\n            <text class=\"wechat-status\">{{ wechatStatusText }}</text>\r\n            <view v-if=\"wechatDisplayName\" class=\"wechat-chip\">{{ wechatDisplayName }}</view>\r\n          </view>\r\n        </view>\r\n        <view class=\"wechat-actions\">\r\n          <button class=\"primary\" :disabled=\"wechatBusy\" @tap=\"handleWeChatBind\">\r\n            {{ wechatBindLabel }}\r\n          </button>\r\n          <button\r\n            v-if=\"isWeChatBound\"\r\n            class=\"ghost\"\r\n            :disabled=\"wechatBusy\"\r\n            @tap=\"handleWeChatUnbind\"\r\n          >\r\n            解绑\r\n          </button>\r\n        </view>\r\n        <view v-if=\"showSubscriptionPanel\" class=\"wechat-subscription\">\r\n          <view v-for=\"option in authorWechatTemplateOptions\" :key=\"option.key\" class=\"subscription-row\">\r\n            <view class=\"subscription-info\">\r\n              <text class=\"subscription-title\">{{ option.title }}</text>\r\n              <text class=\"subscription-desc\">{{ option.description }}</text>\r\n            </view>\r\n            <switch\r\n              class=\"subscription-switch\"\r\n              :checked=\"subscriptionState[option.key] !== false\"\r\n              @change=\"onSubscriptionToggle(option.key, $event.detail.value)\"\r\n              color=\"#22d3ee\"\r\n            />\r\n          </view>\r\n          <button class=\"primary\" :disabled=\"wechatSubscribeBusy\" @tap=\"applySubscriptionRequests()\">\r\n            {{ wechatSubscribeBusy ? '授权中...' : '保存并请求订阅' }}\r\n          </button>\r\n          <text class=\"subscription-hint\">提示：仅对已开启的提醒类型发起订阅请求，可随时调整。</text>\r\n        </view>\r\n        <view v-else class=\"wechat-subscription empty\">\r\n          <text v-if=\"isWeChatBound\">未配置订阅模板，请联系平台管理员设置模板 ID。</text>\r\n          <text v-else>绑定微信后可开启通知提醒。</text>\r\n        </view>\r\n      </view>\r\n\r\n\r\n      <view class=\"glass-card section\">\r\n        <view class=\"section-header\">\r\n          <text class=\"section-title\">选择软件</text>\r\n          <button class=\"link ghost\" @tap=\"startCreate\" :disabled=\"platform.loading.createAuthorSoftware\">\r\n            {{ platform.loading.createAuthorSoftware ? '处理中...' : '新增软件码' }}\r\n          </button>\r\n        </view>\r\n\r\n        <template v-if=\"softwares.length\">\r\n          <view class=\"selector\" v-if=\"softwares.length > 1\">\r\n            <picker :range=\"softwares\" range-key=\"displayName\" @change=\"handleSoftwareChange\">\r\n              <view class=\"picker\">\r\n                {{ currentSoftware?.displayName || '选择软件' }}\r\n              </view>\r\n            </picker>\r\n          </view>\r\n        </template>\r\n        <view v-else class=\"empty-tip\">暂无软件，请先新增。</view>\r\n\r\n        <view class=\"software-list\" v-if=\"softwares.length\">\r\n          <view\r\n            v-for=\"software in softwares\"\r\n            :key=\"software.softwareId\"\r\n            :class=\"['software-card', currentSoftware?.softwareId === software.softwareId ? 'active' : '']\"\r\n          >\r\n            <view class=\"software-header\">\r\n              <text class=\"software-name\">{{ software.displayName }}</text>\r\n              <text class=\"software-tag\">{{ resolveTypeLabel(software.softwareType) }}</text>\r\n            </view>\r\n            <view class=\"software-code-row\">\r\n              <text class=\"software-code\">软件码：{{ software.softwareCode }}</text>\r\n              <button class=\"ghost mini\" @tap=\"copySoftwareCode(software.softwareCode)\">复制</button>\r\n            </view>\r\n            <text class=\"software-endpoint\">接口：{{ software.apiAddress }}:{{ software.apiPort }}</text>\r\n            <view class=\"software-actions\">\r\n              <button\r\n                class=\"ghost small\"\r\n                :disabled=\"currentSoftware?.softwareId === software.softwareId\"\r\n                @tap=\"selectSoftware(software)\"\r\n              >\r\n                {{ currentSoftware?.softwareId === software.softwareId ? '当前使用' : '设为当前' }}\r\n              </button>\r\n              <button class=\"ghost small\" @tap=\"editSoftware(software)\">编辑</button>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <view v-if=\"currentSoftware\" class=\"info\">\r\n          <view class=\"info-item code-line\">\r\n            <text>当前软件码：{{ currentSoftware.softwareCode }}</text>\r\n            <button class=\"ghost mini\" @tap=\"copySoftwareCode(currentSoftware.softwareCode)\">复制</button>\r\n          </view>\r\n          <view class=\"info-actions\">\r\n            <button class=\"link\" @tap=\"handleRegenerate\" :disabled=\"platform.loading.regenerateAuthorCode\">\r\n              {{ platform.loading.regenerateAuthorCode ? '生成中...' : '刷新软件码' }}\r\n            </button>\r\n            <button\r\n              class=\"link danger\"\r\n              @tap=\"handleDeleteSoftware\"\r\n              :disabled=\"platform.loading.deleteAuthorSoftware || softwares.length <= 1\"\r\n            >\r\n              删除软件码\r\n            </button>\r\n          </view>\r\n        </view>\r\n      </view>\r\n\r\n      <view class=\"glass-card section\" v-if=\"isCreating || currentSoftware\">\r\n        <view class=\"section-header\">\r\n          <text class=\"section-title\">{{ isCreating ? '新增软件配置' : '更新接口配置' }}</text>\r\n        </view>\r\n\r\n        <view class=\"form\">\r\n          <view class=\"form-item\">\r\n            <text class=\"label\">展示名称</text>\r\n            <input v-model=\"form.displayName\" class=\"input\" placeholder=\"作者昵称或公司名\" />\r\n          </view>\r\n          <view class=\"form-item\">\r\n            <text class=\"label\">接口地址</text>\r\n            <input v-model=\"form.apiAddress\" class=\"input\" placeholder=\"部署主机 IP 或域名\" />\r\n          </view>\r\n          <view class=\"form-item\">\r\n            <text class=\"label\">接口端口</text>\r\n            <input v-model.number=\"form.apiPort\" class=\"input\" type=\"number\" placeholder=\"如：8080\" />\r\n          </view>\r\n          <view class=\"form-item\">\r\n            <text class=\"label\">软件类型</text>\r\n            <picker :range=\"softwareTypes\" range-key=\"label\" @change=\"handleTypeChange\">\r\n              <view class=\"picker\">{{ currentSoftwareType.label }}</view>\r\n            </picker>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"form-actions\">\r\n          <button class=\"submit\" :disabled=\"saving\" @tap=\"handleSave\">\r\n            {{ saving ? '保存中...' : isCreating ? '提交新增' : '保存修改' }}\r\n          </button>\r\n          <button v-if=\"isCreating\" class=\"ghost\" @tap=\"cancelCreate\">取消</button>\r\n        </view>\r\n      </view>\r\n\r\n      <view v-if=\"!isCreating && currentSoftware\" class=\"glass-card note-card\">\r\n        <text class=\"note-title\">提示</text>\r\n        <text class=\"note-text\">更新后请提醒代理同步新的接口账号密码信息。</text>\r\n      </view>\r\n    </scroll-view>\r\n  </view>\r\n  <view v-else class=\"empty\">\r\n    <text>正在加载作者信息...</text>\r\n  </view>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { computed, onMounted, reactive, ref, watch } from 'vue';\r\nimport { storeToRefs } from 'pinia';\r\nimport type { PlatformAuthorSoftware } from '@/common/types';\r\nimport { usePlatformStore } from '@/stores/platform';\r\n\r\nconst platform = usePlatformStore();\r\nconst { authorWeChatBinding, authorWechatSubscriptions, wechatTemplates, wechatTemplatePreviews } = storeToRefs(platform);\r\nconst profile = computed(() => platform.authorProfile);\r\nconst softwares = computed(() => profile.value?.softwares ?? []);\r\nconst selectedSoftwareId = computed({\r\n  get: () => platform.selectedAuthorSoftwareId,\r\n  set: (value: number | null) => platform.selectAuthorSoftware(value)\r\n});\r\nconst currentSoftware = computed(() => {\r\n  if (!softwares.value.length) {\r\n    return null;\r\n  }\r\n  const matched = softwares.value.find((item) => item.softwareId === selectedSoftwareId.value);\r\n  return matched ?? softwares.value[0] ?? null;\r\n});\r\n\r\ninterface WeChatTemplateOption {\r\n  key: 'instant' | 'blacklist' | 'settlement';\r\n  title: string;\r\n  description: string;\r\n  templateId: string;\r\n  preview?: Record<string, string> | null;\r\n}\r\n\r\nconst isWeChatMiniProgram = ref(false);\r\n\r\nisWeChatMiniProgram.value = true;\r\n\r\n\r\n\r\nconst isWeChatBound = computed(() => Boolean(authorWeChatBinding.value));\r\nconst wechatBusy = computed(\r\n  () =>\r\n    platform.loading.wechatBinding ||\r\n    platform.loading.wechatBind ||\r\n    platform.loading.wechatUnbind\r\n);\r\nconst authorWechatTemplateOptions = computed<WeChatTemplateOption[]>(() => {\r\n  const config = wechatTemplates.value;\r\n  if (!config) {\r\n    return [];\r\n  }\r\n  const candidates: WeChatTemplateOption[] = [\r\n    {\r\n      key: 'instant',\r\n      title: '即时沟通提醒',\r\n      description: '代理或客户有新留言时提醒',\r\n      templateId: config.instantCommunication?.trim() ?? '',\r\n      preview: wechatTemplatePreviews.value?.['instant'] ?? null\r\n    },\r\n    {\r\n      key: 'blacklist',\r\n      title: '黑名单严重警告',\r\n      description: '黑名单触发时快速通知',\r\n      templateId: config.blacklistAlert?.trim() ?? '',\r\n      preview: wechatTemplatePreviews.value?.['blacklist'] ?? null\r\n    },\r\n    {\r\n      key: 'settlement',\r\n      title: '结算账单通知',\r\n      description: '结算周期到期时提醒处理账单',\r\n      templateId: config.settlementNotice?.trim() ?? '',\r\n      preview: wechatTemplatePreviews.value?.['settlement'] ?? null\r\n    }\r\n  ];\r\n  return candidates.filter((item) => item.templateId.length >= 10 && !item.templateId.includes('...'));\r\n});\r\n\r\nconst subscriptionState = computed<Record<string, boolean>>(() => authorWechatSubscriptions.value ?? {});\r\nconst showSubscriptionPanel = computed(() => isWeChatBound.value && authorWechatTemplateOptions.value.length > 0);\r\n\r\nfunction maskOpenId(value?: string | null) {\r\n  if (!value) {\r\n    return '';\r\n  }\r\n  if (value.length <= 6) {\r\n    return value;\r\n  }\r\n  const prefix = value.slice(0, 4);\r\n  const suffix = value.slice(-3);\r\n  return `${prefix}***${suffix}`;\r\n}\r\n\r\nconst wechatDisplayName = computed(() => {\r\n  const binding = authorWeChatBinding.value;\r\n  if (!binding) {\r\n    return '';\r\n  }\r\n  const nickname = binding.nickname?.trim();\r\n  if (nickname) {\r\n    return nickname;\r\n  }\r\n  return maskOpenId(binding.openId);\r\n});\r\n\r\nconst wechatBindLabel = computed(() => {\r\n  if (wechatBusy.value) {\r\n    return '处理中...';\r\n  }\r\n  return isWeChatBound.value ? '重新绑定' : '绑定微信';\r\n});\r\n\r\nconst wechatStatusText = computed(() => {\r\n  if (!isWeChatMiniProgram.value) {\r\n    return '仅微信小程序支持';\r\n  }\r\n  if (wechatBusy.value && !authorWeChatBinding.value) {\r\n    return '加载中...';\r\n  }\r\n  return isWeChatBound.value ? '已绑定' : '未绑定';\r\n});\r\nconst wechatSubscribeBusy = ref(false);\r\n\r\nfunction onSubscriptionToggle(key: string, value: boolean) {\r\n  platform.setAuthorWechatSubscription(key, value);\r\n}\r\n\r\nasync function applySubscriptionRequests(auto = false) {\r\n  if (!isWeChatMiniProgram.value) {\r\n    if (!auto) {\r\n      uni.showToast({ title: '请在微信小程序内操作', icon: 'none' });\r\n    }\r\n    return;\r\n  }\r\n\r\n  await platform.fetchWeChatTemplates().catch(() => undefined);\r\n  const selected = authorWechatTemplateOptions.value.filter((option) => (subscriptionState.value[option.key] ?? true));\r\n  if (!selected.length) {\r\n    if (!auto) {\r\n      uni.showToast({ title: '请至少开启一个提醒类型', icon: 'none' });\r\n    }\r\n    return;\r\n  }\r\n\r\n  const tmplIds = selected.map((option) => option.templateId);\r\n  wechatSubscribeBusy.value = true;\r\n  try {\r\n    await new Promise<void>((resolve, reject) => {\r\n      uni.requestSubscribeMessage({\r\n        tmplIds,\r\n        success: () => resolve(),\r\n        fail: (error) => reject(error)\r\n      });\r\n    });\r\n    if (!auto) {\r\n      uni.showToast({ title: '已提交订阅', icon: 'success' });\r\n    }\r\n\r\n    let previewDelivered = false;\r\n    for (const option of selected) {\r\n      const delivered = await platform.sendWeChatPreview('author', option.key, auto);\r\n      previewDelivered = previewDelivered || delivered;\r\n    }\r\n\r\n    if (!auto && previewDelivered) {\r\n      uni.showToast({ title: '已发送测试提醒', icon: 'success' });\r\n    }\r\n  } catch (error) {\r\n    const rawMessage = (error as any)?.errMsg || (error as any)?.message || '';\r\n    if (typeof rawMessage === 'string' && rawMessage.includes('No template data return')) {\r\n      uni.showModal({\r\n        title: '订阅失败',\r\n        content: '微信返回“未找到模板”，请确认小程序已配置对应的订阅消息模板并在平台中填写正确的模板 ID。',\r\n        showCancel: false\r\n      });\r\n    } else if (!auto) {\r\n      const message = rawMessage || '订阅失败，请稍后重试';\r\n      uni.showToast({ title: message, icon: 'none' });\r\n    }\r\n  } finally {\r\n    wechatSubscribeBusy.value = false;\r\n  }\r\n}\r\n\r\nfunction seedDefaultSubscriptions() {\r\n  if (!isWeChatBound.value || !authorWechatTemplateOptions.value.length) {\r\n    return;\r\n  }\r\n  const current = subscriptionState.value;\r\n  if (current && Object.keys(current).length > 0) {\r\n    return;\r\n  }\r\n  authorWechatTemplateOptions.value.forEach((option) => {\r\n    platform.setAuthorWechatSubscription(option.key, true);\r\n  });\r\n}\r\n\r\nfunction mpLogin(): Promise<string> {\r\n  return new Promise((resolve, reject) => {\r\n    uni.login({\r\n      provider: 'weixin',\r\n      success: (res) => {\r\n        if (res.code) {\r\n          resolve(res.code);\r\n        } else {\r\n          reject(new Error('未获取到登录凭证'));\r\n        }\r\n      },\r\n      fail: (error) => reject(error)\r\n    });\r\n  });\r\n}\r\n\r\nasync function ensureWeChatBinding() {\r\n  if (!isWeChatMiniProgram.value || !platform.isAuthorAuthenticated) {\r\n    return;\r\n  }\r\n  await platform.fetchWeChatBinding('author').catch(() => undefined);\r\n  platform.fetchWeChatTemplates().catch(() => undefined);\r\n}\r\n\r\nwatch(\r\n  () => [authorWeChatBinding.value?.openId ?? null, authorWechatTemplateOptions.value.length],\r\n  () => {\r\n    seedDefaultSubscriptions();\r\n  },\r\n  { immediate: true }\r\n);\r\n\r\nasync function handleWeChatBind() {\r\n  if (!isWeChatMiniProgram.value) {\r\n    uni.showToast({ title: '请在微信小程序内操作', icon: 'none' });\r\n    return;\r\n  }\r\n  try {\r\n    const code = await mpLogin();\r\n    let nickname: string | undefined;\r\n    try {\r\n      if (typeof uni.getUserProfile === 'function') {\r\n        const profile = await new Promise<any>((resolve, reject) => {\r\n          uni.getUserProfile({\r\n            desc: '用于展示绑定的微信昵称',\r\n            success: (res) => resolve(res),\r\n            fail: (error) => reject(error)\r\n          });\r\n        });\r\n        nickname = profile.userInfo?.nickName;\r\n      }\r\n    } catch (error) {\r\n      uni.__f__('warn','at pages/author/dashboard.vue:418','获取作者昵称失败，继续绑定', error);\r\n    }\r\n\r\n    await platform.bindWeChat('author', code, nickname);\r\n    await platform.fetchWeChatTemplates().catch(() => undefined);\r\n    seedDefaultSubscriptions();\r\n    uni.showToast({ title: '绑定成功', icon: 'success' });\r\n\r\n    if (showSubscriptionPanel.value) {\r\n      uni.showModal({\r\n        title: '订阅提醒',\r\n        content: '是否立即授权接收微信通知？',\r\n        confirmText: '立即授权',\r\n        cancelText: '稍后',\r\n        success: (res) => {\r\n          if (res.confirm) {\r\n            applySubscriptionRequests(true).catch(() => undefined);\r\n          }\r\n        }\r\n      });\r\n    }\r\n  } catch (error) {\r\n    const message =\r\n      (error as any)?.errMsg || (error as any)?.message || '绑定失败，请稍后重试';\r\n    uni.showToast({ title: message, icon: 'none' });\r\n  }\r\n}\r\n\r\nasync function handleWeChatUnbind() {\r\n  if (!isWeChatMiniProgram.value || !isWeChatBound.value) {\r\n    return;\r\n  }\r\n\r\n  const confirmed = await new Promise<boolean>((resolve) => {\r\n    uni.showModal({\r\n      title: '确认解绑',\r\n      content: '解绑后将无法接收订阅提醒，是否继续？',\r\n      success: (res) => resolve(res.confirm),\r\n      fail: () => resolve(false)\r\n    });\r\n  });\r\n\r\n  if (!confirmed) {\r\n    return;\r\n  }\r\n\r\n  try {\r\n    await platform.unbindWeChat('author');\r\n    uni.showToast({ title: '已解绑', icon: 'success' });\r\n  } catch (error) {\r\n    const message =\r\n      (error as any)?.errMsg || (error as any)?.message || '解绑失败，请稍后重试';\r\n    uni.showToast({ title: message, icon: 'none' });\r\n  }\r\n}\r\n\r\nconst isCreating = ref(false);\r\nconst form = reactive({\r\n  softwareId: 0,\r\n  displayName: '',\r\n  apiAddress: '',\r\n  apiPort: 8080,\r\n  softwareType: 'SP'\r\n});\r\n\r\nconst softwareTypes = [\r\n  { value: 'SP', label: 'SProtect (默认)' },\r\n  { value: 'QP', label: 'QProtect' },\r\n  { value: 'API', label: '自定义 API' }\r\n];\r\n\r\nconst currentSoftwareType = computed(\r\n  () => softwareTypes.find((item) => item.value === form.softwareType) ?? softwareTypes[0]\r\n);\r\n\r\nconst saving = computed(() =>\r\n  platform.loading.updateAuthor || platform.loading.updateAuthorSoftware || platform.loading.createAuthorSoftware\r\n);\r\n\r\nwatch(\r\n  currentSoftware,\r\n  (software) => {\r\n    if (!software || isCreating.value) {\r\n      return;\r\n    }\r\n    form.softwareId = software.softwareId;\r\n    form.displayName = software.displayName;\r\n    form.apiAddress = software.apiAddress;\r\n    form.apiPort = software.apiPort;\r\n    form.softwareType = software.softwareType;\r\n  },\r\n  { immediate: true }\r\n);\r\n\r\nonMounted(async () => {\r\n  if (!platform.isAuthorAuthenticated) {\r\n    uni.reLaunch({ url: '/pages/login/author' });\r\n    return;\r\n  }\r\n\r\n  if (!profile.value) {\r\n    try {\r\n      await platform.fetchAuthorProfile();\r\n    } catch (error) {\r\n      uni.showToast({ title: '加载作者信息失败', icon: 'none' });\r\n    }\r\n  }\r\n\r\n  await ensureWeChatBinding();\r\n});\r\n\r\nfunction handleTypeChange(event: UniApp.PickerChangeEvent) {\r\n  const index = Number(event.detail.value ?? 0);\r\n  const target = softwareTypes[index] ?? softwareTypes[0];\r\n  form.softwareType = target.value;\r\n}\r\n\r\nfunction handleSoftwareChange(event: UniApp.PickerChangeEvent) {\r\n  const index = Number(event.detail.value ?? 0);\r\n  const target = softwares.value[index];\r\n  if (target) {\r\n    isCreating.value = false;\r\n    platform.selectAuthorSoftware(target.softwareId);\r\n  }\r\n}\r\n\r\nfunction copySoftwareCode(code: string) {\r\n  if (!code) {\r\n    return;\r\n  }\r\n\r\n  uni.setClipboardData({\r\n    data: code,\r\n    success: () => {\r\n      uni.showToast({ title: '软件码已复制', icon: 'none' });\r\n    },\r\n    fail: () => {\r\n      uni.showToast({ title: '复制失败', icon: 'none' });\r\n    }\r\n  });\r\n}\r\n\r\nfunction selectSoftware(software: PlatformAuthorSoftware) {\r\n  isCreating.value = false;\r\n  platform.selectAuthorSoftware(software.softwareId);\r\n}\r\n\r\nfunction editSoftware(software: PlatformAuthorSoftware) {\r\n  selectSoftware(software);\r\n  form.softwareId = software.softwareId;\r\n  form.displayName = software.displayName;\r\n  form.apiAddress = software.apiAddress;\r\n  form.apiPort = software.apiPort;\r\n  form.softwareType = software.softwareType;\r\n  isCreating.value = false;\r\n}\r\n\r\nfunction resolveTypeLabel(type: string) {\r\n  const target = softwareTypes.find((item) => item.value === type);\r\n  return target?.label ?? type;\r\n}\r\n\r\nfunction startCreate() {\r\n  isCreating.value = true;\r\n  form.softwareId = 0;\r\n  form.displayName = '';\r\n  form.apiAddress = '';\r\n  form.apiPort = 8080;\r\n  form.softwareType = 'SP';\r\n}\r\n\r\nfunction cancelCreate() {\r\n  isCreating.value = false;\r\n  if (currentSoftware.value) {\r\n    form.softwareId = currentSoftware.value.softwareId;\r\n    form.displayName = currentSoftware.value.displayName;\r\n    form.apiAddress = currentSoftware.value.apiAddress;\r\n    form.apiPort = currentSoftware.value.apiPort;\r\n    form.softwareType = currentSoftware.value.softwareType;\r\n  }\r\n}\r\n\r\nasync function handleSave() {\r\n  if (!form.displayName || !form.apiAddress) {\r\n    uni.showToast({ title: '请完善信息', icon: 'none' });\r\n    return;\r\n  }\r\n\r\n  try {\r\n    if (isCreating.value) {\r\n      const software = await platform.createAuthorSoftware({\r\n        displayName: form.displayName.trim(),\r\n        apiAddress: form.apiAddress.trim(),\r\n        apiPort: form.apiPort,\r\n        softwareType: form.softwareType\r\n      });\r\n      isCreating.value = false;\r\n      uni.showToast({ title: `已新增：${software.softwareCode}`, icon: 'none' });\r\n    } else if (form.softwareId) {\r\n      await platform.updateAuthorSoftware(form.softwareId, {\r\n        displayName: form.displayName.trim(),\r\n        apiAddress: form.apiAddress.trim(),\r\n        apiPort: form.apiPort,\r\n        softwareType: form.softwareType\r\n      });\r\n      uni.showToast({ title: '已保存', icon: 'success' });\r\n    }\r\n  } catch (error) {\r\n    const message = (error as any)?.message && typeof (error as any).message === 'string'\r\n      ? (error as any).message\r\n      : '操作失败，请稍后重试';\r\n    uni.showToast({ title: message, icon: 'none' });\r\n  }\r\n}\r\n\r\nasync function handleRegenerate() {\r\n  if (!currentSoftware.value) {\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const code = await platform.regenerateAuthorCode(currentSoftware.value.softwareId);\r\n    uni.showToast({ title: `新软件码：${code}`, icon: 'none' });\r\n    await platform.fetchAuthorProfile();\r\n  } catch (error) {\r\n    const message = (error as any)?.message && typeof (error as any).message === 'string'\r\n      ? (error as any).message\r\n      : '生成失败，请稍后重试';\r\n    uni.showToast({ title: message, icon: 'none' });\r\n  }\r\n}\r\n\r\nfunction handleLogout() {\r\n  platform.logoutAuthor();\r\n  uni.reLaunch({ url: '/pages/login/author' });\r\n}\r\n\r\nfunction handleDeleteAccount() {\r\n  uni.showModal({\r\n    title: '确认注销作者账号',\r\n    content: '该操作不可恢复，确认继续？',\r\n    success: async (res) => {\r\n      if (!res.confirm) return;\r\n      try {\r\n        await platform.deleteAuthorAccount();\r\n        uni.showToast({ title: '账号已注销', icon: 'none' });\r\n        uni.reLaunch({ url: '/pages/login/author' });\r\n      } catch (error) {\r\n        const message = (error as any)?.message && typeof (error as any).message === 'string'\r\n          ? (error as any).message\r\n          : '操作失败，请稍后重试';\r\n        uni.showToast({ title: message, icon: 'none' });\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nfunction handleDeleteSoftware() {\r\n  if (!currentSoftware.value || softwares.value.length <= 1) {\r\n    return;\r\n  }\r\n\r\n  uni.showModal({\r\n    title: '确认删除软件码',\r\n    content: '删除后代理无法再使用此软件码，是否继续？',\r\n    success: async (res) => {\r\n      if (!res.confirm || !currentSoftware.value) return;\r\n      try {\r\n        await platform.deleteAuthorSoftware(currentSoftware.value.softwareId);\r\n        uni.showToast({ title: '已删除', icon: 'success' });\r\n      } catch (error) {\r\n        const message = (error as any)?.message && typeof (error as any).message === 'string'\r\n          ? (error as any).message\r\n          : '删除失败，请稍后重试';\r\n        uni.showToast({ title: message, icon: 'none' });\r\n      }\r\n    }\r\n  });\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.page {\r\n  min-height: 100vh;\r\n  padding: 40rpx 32rpx 80rpx;\r\n  background: rgba(2, 6, 23, 0.9);\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.top-bar {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.page-title {\r\n  font-size: 40rpx;\r\n  font-weight: 600;\r\n  color: #f8fafc;\r\n}\r\n\r\n.top-actions {\r\n  display: flex;\r\n  gap: 16rpx;\r\n}\r\n\r\n.content {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 32rpx;\r\n}\r\n\r\n.section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 24rpx;\r\n  padding: 32rpx 28rpx;\r\n}\r\n\r\n.wechat-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  gap: 16rpx;\r\n}\r\n\r\n.wechat-status-group {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12rpx;\r\n}\r\n\r\n.wechat-status {\r\n  font-size: 28rpx;\r\n  color: rgba(226, 232, 240, 0.85);\r\n}\r\n\r\n.wechat-chip {\r\n  padding: 6rpx 20rpx;\r\n  border-radius: 999rpx;\r\n  background: rgba(59, 130, 246, 0.2);\r\n  color: #bfdbfe;\r\n  font-size: 24rpx;\r\n  font-weight: 500;\r\n}\r\n\r\n.wechat-actions {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 16rpx;\r\n  align-items: center;\r\n  margin-top: 12rpx;\r\n}\r\n\r\n.wechat-subscription {\r\n  margin-top: 18rpx;\r\n  padding: 20rpx;\r\n  border-radius: 20rpx;\r\n  background: rgba(15, 23, 42, 0.55);\r\n  border: 1px solid rgba(148, 163, 184, 0.25);\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 18rpx;\r\n}\r\n\r\n.subscription-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  gap: 16rpx;\r\n  align-items: center;\r\n}\r\n\r\n.subscription-info {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 6rpx;\r\n  flex: 1;\r\n}\r\n\r\n.subscription-title {\r\n  font-size: 26rpx;\r\n  font-weight: 600;\r\n  color: #f8fafc;\r\n}\r\n\r\n.subscription-desc {\r\n  font-size: 22rpx;\r\n  color: rgba(226, 232, 240, 0.7);\r\n}\r\n\r\n.subscription-switch {\r\n  transform: scale(0.9);\r\n}\r\n\r\n.subscription-hint {\r\n  font-size: 22rpx;\r\n  color: rgba(203, 213, 225, 0.75);\r\n}\r\n\r\n.wechat-subscription.empty {\r\n  margin-top: 16rpx;\r\n  font-size: 24rpx;\r\n  color: rgba(226, 232, 240, 0.7);\r\n  line-height: 1.5;\r\n}\r\n\r\n.section-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.section-title {\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n  color: #f8fafc;\r\n}\r\n\r\n.selector {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12rpx;\r\n}\r\n\r\n.picker {\r\n  padding: 18rpx 24rpx;\r\n  border-radius: 16rpx;\r\n  background: rgba(15, 23, 42, 0.55);\r\n  color: #e0f2fe;\r\n  font-size: 26rpx;\r\n}\r\n\r\n.software-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20rpx;\r\n  margin-top: 24rpx;\r\n}\r\n\r\n.software-card {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12rpx;\r\n  padding: 24rpx;\r\n  border-radius: 20rpx;\r\n  background: rgba(15, 23, 42, 0.55);\r\n  border: 1px solid rgba(148, 163, 184, 0.25);\r\n  transition: border-color 0.2s ease, transform 0.2s ease;\r\n}\r\n\r\n.software-card.active {\r\n  border-color: rgba(96, 165, 250, 0.75);\r\n  box-shadow: 0 12rpx 28rpx rgba(59, 130, 246, 0.25);\r\n  transform: translateY(-4rpx);\r\n}\r\n\r\n.software-header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 12rpx;\r\n}\r\n\r\n.software-name {\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n  color: #f8fafc;\r\n}\r\n\r\n.software-tag {\r\n  padding: 8rpx 18rpx;\r\n  border-radius: 999rpx;\r\n  background: rgba(59, 130, 246, 0.2);\r\n  color: rgba(191, 219, 254, 0.95);\r\n  font-size: 22rpx;\r\n}\r\n\r\n.software-code,\r\n.software-endpoint {\r\n  font-size: 24rpx;\r\n  color: rgba(226, 232, 240, 0.82);\r\n}\r\n\r\n.software-code-row {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 16rpx;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.software-actions {\r\n  display: flex;\r\n  gap: 16rpx;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.ghost.small {\r\n  flex: 1;\r\n  min-width: 220rpx;\r\n  padding: 22rpx 0;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.info {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12rpx;\r\n  color: rgba(226, 232, 240, 0.9);\r\n  font-size: 26rpx;\r\n}\r\n\r\n.info-item.code-line {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 16rpx;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.info-actions {\r\n  display: flex;\r\n  gap: 16rpx;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.form {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20rpx;\r\n}\r\n\r\n.form-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10rpx;\r\n}\r\n\r\n.label {\r\n  font-size: 24rpx;\r\n  color: rgba(148, 163, 184, 0.85);\r\n}\r\n\r\n.input {\r\n  padding: 18rpx 24rpx;\r\n  border-radius: 16rpx;\r\n  background: rgba(15, 23, 42, 0.55);\r\n  border: 1px solid rgba(148, 163, 184, 0.2);\r\n  color: #e2e8f0;\r\n  font-size: 26rpx;\r\n}\r\n\r\n.form-actions {\r\n  display: flex;\r\n  gap: 16rpx;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.submit {\r\n  flex: 1;\r\n  min-width: 220rpx;\r\n  padding: 24rpx 0;\r\n  border: none;\r\n  border-radius: 18rpx;\r\n  background: linear-gradient(135deg, #38bdf8, #6366f1);\r\n  color: #fff;\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n}\r\n\r\n.link {\r\n  padding: 14rpx 24rpx;\r\n  border: none;\r\n  background: rgba(59, 130, 246, 0.2);\r\n  color: rgba(191, 219, 254, 0.95);\r\n  border-radius: 14rpx;\r\n  font-size: 24rpx;\r\n}\r\n\r\n.link.ghost {\r\n  background: rgba(148, 163, 184, 0.25);\r\n  color: rgba(226, 232, 240, 0.9);\r\n}\r\n\r\n.link.danger {\r\n  background: rgba(248, 113, 113, 0.2);\r\n  color: #fecaca;\r\n}\r\n\r\n.link:disabled {\r\n  opacity: 0.6;\r\n}\r\n\r\n.primary {\r\n  padding: 22rpx 40rpx;\r\n  border-radius: 16rpx;\r\n  border: none;\r\n  background: linear-gradient(135deg, #60a5fa, #6366f1);\r\n  color: #0f172a;\r\n  font-size: 26rpx;\r\n  font-weight: 600;\r\n}\r\n\r\n.ghost {\r\n  padding: 22rpx 40rpx;\r\n  border-radius: 16rpx;\r\n  background: rgba(148, 163, 184, 0.2);\r\n  color: rgba(226, 232, 240, 0.9);\r\n  border: none;\r\n  font-size: 26rpx;\r\n}\r\n\r\n.ghost.mini {\r\n  padding: 16rpx 28rpx;\r\n  font-size: 24rpx;\r\n  min-width: auto;\r\n}\r\n\r\n.danger {\r\n  padding: 22rpx 40rpx;\r\n  border-radius: 16rpx;\r\n  border: none;\r\n  background: linear-gradient(135deg, #ef4444, #b91c1c);\r\n  color: #fff;\r\n  font-size: 26rpx;\r\n  font-weight: 600;\r\n}\r\n\r\n.note-card {\r\n  padding: 28rpx 24rpx;\r\n  gap: 12rpx;\r\n}\r\n\r\n.note-title {\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n  color: #bae6fd;\r\n}\r\n\r\n.note-text {\r\n  font-size: 24rpx;\r\n  color: rgba(191, 219, 254, 0.85);\r\n}\r\n\r\n.empty {\r\n  min-height: 100vh;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: rgba(148, 163, 184, 0.8);\r\n  font-size: 28rpx;\r\n}\r\n\r\n.empty-tip {\r\n  font-size: 24rpx;\r\n  color: rgba(148, 163, 184, 0.8);\r\n}\r\n</style>\r\n","import MiniProgramPage from 'C:/Users/Administrator/source/repos/wwwskbjxyz/SPTEST-V1/SProtectAgentWeb.Api/wwwroot/uniapp/pages/author/dashboard.vue'\nwx.createPage(MiniProgramPage)"],"names":["usePlatformStore","storeToRefs","computed","ref","uni","watch","profile","reactive","onMounted"],"mappings":"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"}
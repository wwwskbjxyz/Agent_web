{"version":3,"file":"index.js","sources":["pages/chat/index.vue","E:/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2hhdC9pbmRleC52dWU"],"sourcesContent":["<template>\r\n  <view class=\"page\">\r\n    <view class=\"header glass-card\">\r\n      <view>\r\n        <text class=\"title\">Âç≥Êó∂Ê≤üÈÄö</text>\r\n        <text class=\"subtitle\">‰∏éÊ∏†ÈÅì‰ª£ÁêÜÂÆûÊó∂ÂêåÊ≠•Â∑°Ê£Ä‰∏éÂçèÂêåËøõÂ∫¶</text>\r\n      </view>\r\n      <view class=\"header-actions\">\r\n        <SoftwarePicker />\r\n        <button class=\"header-btn\" @tap=\"startDirectSession\">ÂèëËµ∑ÂçïËÅä</button>\r\n        <button class=\"header-btn ghost\" @tap=\"openGroupDialog\">ÂàõÂª∫Áæ§ËÅä</button>\r\n      </view>\r\n    </view>\r\n\r\n    <view class=\"chat-layout\">\r\n      <view class=\"session-panel glass-card\">\r\n        <view class=\"session-header\">\r\n          <text class=\"session-title\">‰ºöËØùÂàóË°®</text>\r\n          <text class=\"session-counter\">{{ sessions.length }} ‰∏™‰ºöËØù</text>\r\n        </view>\r\n        <view v-if=\"loadingSessions\" class=\"session-empty\">Âä†ËΩΩ‰∏≠...</view>\r\n        <view v-else-if=\"!sessions.length\" class=\"session-empty\">ÊöÇÊó†‰ºöËØùÔºåÁÇπÂáªÂè≥‰∏äËßíÂç≥ÂèØÂàõÂª∫</view>\r\n        <scroll-view v-else scroll-y class=\"session-list\" :show-scrollbar=\"false\">\r\n          <view\r\n            v-for=\"item in sessions\"\r\n            :key=\"item.id\"\r\n            :class=\"['session-item', { active: item.id === activeSessionId }]\"\r\n            @tap=\"selectSession(item.id)\"\r\n          >\r\n            <view class=\"session-title-row\">\r\n              <text class=\"session-name\">{{ item.title }}</text>\r\n              <view v-if=\"item.unread\" class=\"session-unread\">{{ item.unread }}</view>\r\n            </view>\r\n            <text class=\"session-preview\">{{ item.preview || 'ÊöÇÊú™ÂºÄÂßãÂØπËØù' }}</text>\r\n            <text class=\"session-time\">{{ item.updatedAt }}</text>\r\n          </view>\r\n        </scroll-view>\r\n      </view>\r\n\r\n      <view class=\"chat-panel glass-card\">\r\n        <view v-if=\"!activeSession\" class=\"chat-empty\">\r\n          ËØ∑ÈÄâÊã©Â∑¶‰æß‰ºöËØùÊàñÁÇπÂáª‚ÄúÊñ∞Âª∫‰ºöËØù‚ÄùÂèëËµ∑Ê≤üÈÄö\r\n        </view>\r\n        <view v-else class=\"chat-body\">\r\n          <view class=\"chat-meta\">\r\n            <view>\r\n              <text class=\"chat-title\">{{ activeSession.title }}</text>\r\n              <text class=\"chat-subtitle\">{{ activeSession.participants.join('„ÄÅ') }}</text>\r\n            </view>\r\n            <button class=\"chat-action\" @tap=\"exportHistory\">ÂØºÂá∫ËÆ∞ÂΩï</button>\r\n          </view>\r\n\r\n          <scroll-view scroll-y class=\"message-list\" :show-scrollbar=\"false\" :scroll-into-view=\"lastMessageId\">\r\n            <view\r\n              v-for=\"message in activeSession.messages\"\r\n              :key=\"message.id\"\r\n              :id=\"message.id\"\r\n              :class=\"['message', message.sender === 'user' ? 'self' : 'system']\"\r\n            >\r\n              <template v-if=\"message.type === 'image'\">\r\n                <image\r\n                  class=\"message-image\"\r\n                  mode=\"widthFix\"\r\n                  :src=\"message.content\"\r\n                  @tap=\"previewImage(message.content)\"\r\n                />\r\n                <text\r\n                  v-if=\"message.caption\"\r\n                  class=\"message-caption copyable\"\r\n                  @longpress=\"copyContent(message.caption)\"\r\n                >\r\n                  {{ message.caption }}\r\n                </text>\r\n              </template>\r\n              <text\r\n                v-else\r\n                class=\"message-content copyable\"\r\n                @longpress=\"copyContent(message.content)\"\r\n              >\r\n                {{ message.content }}\r\n              </text>\r\n              <text class=\"message-time copyable\" @longpress=\"copyContent(message.time)\">{{ message.time }}</text>\r\n            </view>\r\n            <view v-if=\"loadingMessages\" class=\"message-loading\">Ê∂àÊÅØÂä†ËΩΩ‰∏≠...</view>\r\n          </scroll-view>\r\n\r\n          <view class=\"composer glass-light\">\r\n            <view class=\"composer-toolbar\">\r\n              <button class=\"tool-btn\" @tap=\"toggleEmojiPanel\">üòä</button>\r\n              <button class=\"tool-btn\" :disabled=\"sending || sendingImage\" @tap=\"chooseImage\">üìé</button>\r\n            </view>\r\n            <textarea\r\n              v-model=\"draft\"\r\n              class=\"composer-input\"\r\n              placeholder=\"ËæìÂÖ•Ê∂àÊÅØÂÜÖÂÆπÔºåÊîØÊåÅÂø´Êç∑ÂêåÊ≠•Â∑°Ê£ÄÁªìÊûú\"\r\n              :maxlength=\"500\"\r\n              auto-height\r\n            />\r\n            <view v-if=\"emojiPanelVisible\" class=\"emoji-panel\">\r\n              <text v-for=\"emoji in emojiList\" :key=\"emoji\" class=\"emoji-item\" @tap=\"insertEmoji(emoji)\">{{ emoji }}</text>\r\n            </view>\r\n            <button class=\"composer-send\" :disabled=\"!draft.trim() || sending || sendingImage\" @tap=\"sendMessage\">\r\n              {{ sending ? 'ÂèëÈÄÅ‰∏≠...' : 'ÂèëÈÄÅÊ∂àÊÅØ' }}\r\n            </button>\r\n          </view>\r\n      </view>\r\n    </view>\r\n  </view>\r\n  <view v-if=\"showGroupDialog\" class=\"group-modal\" @tap=\"closeGroupDialog\">\r\n    <view class=\"group-panel glass-card\" @tap.stop=\"\">\r\n      <view class=\"group-header\">\r\n        <text class=\"group-title\">ÂàõÂª∫Áæ§ËÅä</text>\r\n        <button class=\"group-close\" @tap=\"closeGroupDialog\">ÂÖ≥Èó≠</button>\r\n      </view>\r\n      <input class=\"group-input\" v-model=\"groupName\" placeholder=\"ËØ∑ËæìÂÖ•Áæ§ËÅäÂêçÁß∞\" />\r\n      <textarea\r\n        class=\"group-textarea\"\r\n        v-model=\"groupMessage\"\r\n        placeholder=\"È¶ñÊù°Ê∂àÊÅØÔºàÂèØÈÄâÔºâ\"\r\n        auto-height\r\n      />\r\n      <scroll-view scroll-y class=\"group-list\" :show-scrollbar=\"false\">\r\n        <view\r\n          v-for=\"contact in contacts\"\r\n          :key=\"contact.username\"\r\n          :class=\"['group-item', { selected: selectedMembers.includes(contact.username) }]\"\r\n          @tap=\"toggleMember(contact.username)\"\r\n        >\r\n          <text class=\"group-name\">{{ contact.displayName }}</text>\r\n          <text class=\"group-username\">{{ contact.username }}</text>\r\n          <text v-if=\"contact.remark\" class=\"group-remark\">{{ contact.remark }}</text>\r\n        </view>\r\n      </scroll-view>\r\n      <view class=\"group-actions\">\r\n        <button\r\n          class=\"group-btn\"\r\n          :disabled=\"!groupName || !groupName.trim() || !selectedMembers.length\"\r\n          @tap=\"confirmGroupSession\"\r\n        >\r\n          ÂàõÂª∫\r\n        </button>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</view>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { computed, nextTick, onMounted, ref, watch } from 'vue';\r\nimport { storeToRefs } from 'pinia';\r\nimport SoftwarePicker from '@/components/SoftwarePicker.vue';\r\nimport { useAppStore } from '@/stores/app';\r\nimport { downloadTextFile } from '@/utils/download';\r\n\r\nconst appStore = useAppStore();\r\nconst { chatSessions, chatContacts, selectedSoftware } = storeToRefs(appStore);\r\n\r\nconst sessions = computed(() => chatSessions.value);\r\nconst contacts = computed(() => chatContacts.value);\r\nconst loadingSessions = computed(() => appStore.loading.chat);\r\nconst loadingMessages = computed(() => appStore.loading.chatMessages);\r\nconst activeSessionId = ref('');\r\nconst draft = ref('');\r\nconst sending = ref(false);\r\nconst lastMessageId = ref('');\r\n\r\nconst activeSession = computed(() => sessions.value.find((item) => item.id === activeSessionId.value) ?? null);\r\nconst emojiList = ['üòÄ', 'üòÅ', 'üòÇ', 'ü§£', 'üòä', 'üòç', 'ü§î', 'üëç', 'üéâ', 'üî•', '‚ù§Ô∏è', 'üöÄ', 'üôè', 'üòé', 'ü•≥'];\r\nconst emojiPanelVisible = ref(false);\r\nconst sendingImage = ref(false);\r\nconst showGroupDialog = ref(false);\r\nconst groupName = ref('');\r\nconst groupMessage = ref('');\r\nconst selectedMembers = ref<string[]>([]);\r\n\r\nonMounted(async () => {\r\n  await appStore.ensureReady();\r\n  await appStore.loadChatContacts();\r\n  await appStore.loadChatSessions();\r\n  ensureActiveSession();\r\n});\r\n\r\nwatch(sessions, () => {\r\n  ensureActiveSession();\r\n  updateLastMessage();\r\n});\r\n\r\nwatch(\r\n  () => selectedSoftware.value,\r\n  async (next, prev) => {\r\n    if (!next || next === prev) return;\r\n    activeSessionId.value = '';\r\n    await appStore.loadChatContacts(true);\r\n    await appStore.loadChatSessions();\r\n    ensureActiveSession();\r\n  }\r\n);\r\n\r\nwatch(activeSessionId, async (next) => {\r\n  if (!next) return;\r\n  await loadMessages(next);\r\n});\r\n\r\nasync function loadMessages(conversationId: string) {\r\n  await appStore.loadChatMessages(conversationId);\r\n  updateLastMessage();\r\n}\r\n\r\nfunction ensureActiveSession() {\r\n  if (activeSessionId.value && sessions.value.some((item) => item.id === activeSessionId.value)) {\r\n    return;\r\n  }\r\n  activeSessionId.value = sessions.value[0]?.id ?? '';\r\n}\r\n\r\nfunction updateLastMessage() {\r\n  nextTick(() => {\r\n    const target = activeSession.value;\r\n    if (!target || !target.messages.length) {\r\n      lastMessageId.value = '';\r\n      return;\r\n    }\r\n    lastMessageId.value = target.messages[target.messages.length - 1].id;\r\n  });\r\n}\r\n\r\nasync function selectSession(id: string) {\r\n  if (id === activeSessionId.value) return;\r\n  activeSessionId.value = id;\r\n  emojiPanelVisible.value = false;\r\n}\r\n\r\nasync function startDirectSession() {\r\n  await appStore.ensureReady();\r\n  if (!selectedSoftware.value) {\r\n    uni.showToast({ title: 'ËØ∑ÂÖàÈÄâÊã©ËΩØ‰ª∂‰Ωç', icon: 'none' });\r\n    return;\r\n  }\r\n  const list = contacts.value.length ? contacts.value : await appStore.loadChatContacts(true);\r\n  if (!list || !list.length) {\r\n    uni.showToast({ title: 'ÊöÇÊó†ÂèØÁî®ËÅîÁ≥ª‰∫∫', icon: 'none' });\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const actionResult = await new Promise<UniApp.ShowActionSheetSuccessCallbackResult>((resolve, reject) => {\r\n      uni.showActionSheet({\r\n        itemList: list.map((item) => `${item.displayName}${item.displayName !== item.username ? `Ôºà${item.username}Ôºâ` : ''}`),\r\n        success: resolve,\r\n        fail: reject\r\n      });\r\n    });\r\n\r\n    const target = list[actionResult.tapIndex];\r\n    if (!target) return;\r\n\r\n    const messageResult = await new Promise<UniApp.ShowModalRes>((resolve, reject) => {\r\n      uni.showModal({\r\n        title: 'ÂèëÈÄÅÈ¶ñÊù°Ê∂àÊÅØ',\r\n        editable: true,\r\n        placeholderText: 'ËæìÂÖ•Ë¶ÅÂèëÈÄÅÁöÑÂÜÖÂÆπ',\r\n        confirmText: 'ÂèëÈÄÅ',\r\n        cancelText: 'ÂèñÊ∂à',\r\n        success: resolve,\r\n        fail: reject\r\n      });\r\n    });\r\n\r\n    if (!messageResult.confirm || !messageResult.content || !messageResult.content.trim()) {\r\n      return;\r\n    }\r\n\r\n    uni.showLoading({ title: 'ÂàõÂª∫‰∏≠...', mask: true });\r\n    const conversation = await appStore.createDirectConversation(target.username, messageResult.content.trim());\r\n    activeSessionId.value = conversation.id;\r\n    await loadMessages(conversation.id);\r\n    emojiPanelVisible.value = false;\r\n    uni.showToast({ title: '‰ºöËØùÂ∑≤ÂàõÂª∫', icon: 'success' });\r\n  } catch (error) {\r\n    if ((error as UniApp.GeneralCallbackResult)?.errMsg?.includes('cancel')) {\r\n      return;\r\n    }\r\n    uni.__f__('error','at pages/chat/index.vue:283','startDirectSession error', error);\r\n    uni.showToast({ title: 'ÂàõÂª∫‰ºöËØùÂ§±Ë¥•', icon: 'none' });\r\n  } finally {\r\n    uni.hideLoading();\r\n  }\r\n}\r\n\r\nasync function openGroupDialog() {\r\n  await appStore.ensureReady();\r\n  if (!selectedSoftware.value) {\r\n    uni.showToast({ title: 'ËØ∑ÂÖàÈÄâÊã©ËΩØ‰ª∂‰Ωç', icon: 'none' });\r\n    return;\r\n  }\r\n  const list = contacts.value.length ? contacts.value : await appStore.loadChatContacts(true);\r\n  if (!list || !list.length) {\r\n    uni.showToast({ title: 'ÊöÇÊó†ÂèØÁî®ËÅîÁ≥ª‰∫∫', icon: 'none' });\r\n    return;\r\n  }\r\n  groupName.value = '';\r\n  groupMessage.value = '';\r\n  selectedMembers.value = [];\r\n  emojiPanelVisible.value = false;\r\n  showGroupDialog.value = true;\r\n}\r\n\r\nfunction closeGroupDialog() {\r\n  showGroupDialog.value = false;\r\n  emojiPanelVisible.value = false;\r\n}\r\n\r\nfunction toggleMember(username: string) {\r\n  if (!username) return;\r\n  const list = [...selectedMembers.value];\r\n  const index = list.indexOf(username);\r\n  if (index >= 0) {\r\n    list.splice(index, 1);\r\n  } else {\r\n    list.push(username);\r\n  }\r\n  selectedMembers.value = list;\r\n}\r\n\r\nasync function confirmGroupSession() {\r\n  const name = groupName.value.trim();\r\n  if (!name) {\r\n    uni.showToast({ title: 'ËØ∑ËæìÂÖ•Áæ§ËÅäÂêçÁß∞', icon: 'none' });\r\n    return;\r\n  }\r\n  if (!selectedMembers.value.length) {\r\n    uni.showToast({ title: 'ËØ∑ÈÄâÊã©ÊàêÂëò', icon: 'none' });\r\n    return;\r\n  }\r\n\r\n  try {\r\n    uni.showLoading({ title: 'ÂàõÂª∫‰∏≠...', mask: true });\r\n    const initial = groupMessage.value.trim();\r\n    const conversation = await appStore.createGroupConversation(\r\n      name,\r\n      selectedMembers.value,\r\n      initial ? { content: initial } : undefined\r\n    );\r\n    showGroupDialog.value = false;\r\n    groupName.value = '';\r\n    groupMessage.value = '';\r\n    selectedMembers.value = [];\r\n    emojiPanelVisible.value = false;\r\n    activeSessionId.value = conversation.id;\r\n    await loadMessages(conversation.id);\r\n    uni.showToast({ title: 'Áæ§ËÅäÂ∑≤ÂàõÂª∫', icon: 'success' });\r\n  } catch (error) {\r\n    uni.__f__('error','at pages/chat/index.vue:353','confirmGroupSession error', error);\r\n    uni.showToast({ title: 'ÂàõÂª∫Â§±Ë¥•', icon: 'none' });\r\n  } finally {\r\n    uni.hideLoading();\r\n  }\r\n}\r\n\r\nasync function exportHistory() {\r\n  const session = activeSession.value;\r\n  if (!session) {\r\n    uni.showToast({ title: 'ËØ∑ÂÖàÈÄâÊã©‰ºöËØù', icon: 'none' });\r\n    return;\r\n  }\r\n\r\n  try {\r\n    uni.showLoading({ title: 'ÂØºÂá∫‰∏≠...', mask: true });\r\n    const result = await appStore.exportChatHistory(session.id);\r\n    downloadTextFile(result.filename, result.content);\r\n    uni.showToast({ title: 'ÂØºÂá∫ÂÆåÊàê', icon: 'success' });\r\n  } catch (error) {\r\n    uni.__f__('error','at pages/chat/index.vue:373','exportHistory error', error);\r\n    uni.showToast({ title: 'ÂØºÂá∫Â§±Ë¥•', icon: 'none' });\r\n  } finally {\r\n    uni.hideLoading();\r\n  }\r\n}\r\n\r\nasync function sendMessage() {\r\n  const session = activeSession.value;\r\n  if (!session || !draft.value.trim()) {\r\n    return;\r\n  }\r\n\r\n  sending.value = true;\r\n  const content = draft.value.trim();\r\n\r\n  try {\r\n    await appStore.sendChatMessage(session.id, content);\r\n    draft.value = '';\r\n    emojiPanelVisible.value = false;\r\n    await loadMessages(session.id);\r\n  } finally {\r\n    sending.value = false;\r\n  }\r\n}\r\n\r\nfunction toggleEmojiPanel() {\r\n  emojiPanelVisible.value = !emojiPanelVisible.value;\r\n}\r\n\r\nfunction insertEmoji(emoji: string) {\r\n  draft.value += emoji;\r\n}\r\n\r\nfunction copyContent(value?: string) {\r\n  const text = (value ?? '').toString().trim();\r\n  if (!text) {\r\n    uni.showToast({ title: 'Êó†ÂèØÂ§çÂà∂ÂÜÖÂÆπ', icon: 'none' });\r\n    return;\r\n  }\r\n  uni.setClipboardData({\r\n    data: text,\r\n    success: () => {\r\n      uni.showToast({ title: 'Â∑≤Â§çÂà∂', icon: 'success', duration: 800 });\r\n    },\r\n    fail: () => {\r\n      uni.showToast({ title: 'Â§çÂà∂Â§±Ë¥•', icon: 'none' });\r\n    }\r\n  });\r\n}\r\n\r\nfunction previewImage(src: string) {\r\n  if (!src) return;\r\n  uni.previewImage({ urls: [src] });\r\n}\r\n\r\nasync function readImageAsBase64(\r\n  result: UniApp.ChooseImageSuccessCallbackResult,\r\n  path: string\r\n): Promise<{ base64: string; fileName: string }> {\r\n  const tempFile = (result.tempFiles && result.tempFiles[0]) as any;\r\n  if (tempFile && tempFile.file) {\r\n    const file = tempFile.file as File;\r\n    const dataUrl: string = await new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.onload = () => resolve((reader.result as string) || '');\r\n      reader.onerror = () => reject(new Error('ËØªÂèñÊñá‰ª∂Â§±Ë¥•'));\r\n      reader.readAsDataURL(file);\r\n    });\r\n    const base64 = dataUrl.includes(',') ? dataUrl.split(',')[1] ?? '' : dataUrl;\r\n    return { base64, fileName: file.name || 'image.jpg' };\r\n  }\r\n\r\n  if (typeof uni.getFileSystemManager === 'function') {\r\n    try {\r\n      const fs = uni.getFileSystemManager();\r\n      const base64 = await new Promise<string>((resolve, reject) => {\r\n        fs.readFile({\r\n          filePath: path,\r\n          encoding: 'base64',\r\n          success: (res) => resolve(res.data as string),\r\n          fail: reject\r\n        });\r\n      });\r\n      return { base64, fileName: path.split('/').pop() || 'image.jpg' };\r\n    } catch (error) {\r\n      uni.__f__('error','at pages/chat/index.vue:459','readFileSystem error', error);\r\n    }\r\n  }\r\n\r\n  const base64 = await new Promise<string>((resolve, reject) => {\r\n    uni.request({\r\n      url: path,\r\n      method: 'GET',\r\n      responseType: 'arraybuffer',\r\n      success: (res) => {\r\n        resolve(uni.arrayBufferToBase64(res.data as ArrayBuffer));\r\n      },\r\n      fail: reject\r\n    });\r\n  });\r\n  return { base64, fileName: path.split('/').pop() || 'image.jpg' };\r\n}\r\n\r\nasync function chooseImage() {\r\n  const session = activeSession.value;\r\n  if (!session) {\r\n    uni.showToast({ title: 'ËØ∑ÂÖàÈÄâÊã©‰ºöËØù', icon: 'none' });\r\n    return;\r\n  }\r\n  if (sendingImage.value) {\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const result = await new Promise<UniApp.ChooseImageSuccessCallbackResult>((resolve, reject) => {\r\n      uni.chooseImage({\r\n        count: 1,\r\n        sizeType: ['compressed', 'original'],\r\n        success: resolve,\r\n        fail: reject\r\n      });\r\n    });\r\n\r\n    if (!result.tempFilePaths || !result.tempFilePaths.length) {\r\n      return;\r\n    }\r\n\r\n    sendingImage.value = true;\r\n    const path = result.tempFilePaths[0];\r\n    const { base64, fileName } = await readImageAsBase64(result, path);\r\n    const caption = draft.value.trim();\r\n\r\n    await appStore.sendChatMessage(session.id, caption, {\r\n      type: 'image',\r\n      mediaBase64: base64,\r\n      mediaName: fileName,\r\n      caption\r\n    });\r\n\r\n    draft.value = '';\r\n    emojiPanelVisible.value = false;\r\n    await loadMessages(session.id);\r\n    uni.showToast({ title: 'ÂõæÁâáÂ∑≤ÂèëÈÄÅ', icon: 'success' });\r\n  } catch (error) {\r\n    if ((error as UniApp.GeneralCallbackResult)?.errMsg?.includes('cancel')) {\r\n      return;\r\n    }\r\n    uni.__f__('error','at pages/chat/index.vue:521','chooseImage error', error);\r\n    uni.showToast({ title: 'ÂèëÈÄÅÂ§±Ë¥•', icon: 'none' });\r\n  } finally {\r\n    sendingImage.value = false;\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.page {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 32rpx;\r\n  padding: 40rpx 28rpx 80rpx;\r\n}\r\n\r\n.header {\r\n  padding: 32rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 18rpx;\r\n\r\n  @media (min-width: 768px) {\r\n    flex-direction: row;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n  }\r\n}\r\n\r\n.title {\r\n  font-size: 42rpx;\r\n  font-weight: 600;\r\n  color: var(--text-primary);\r\n}\r\n\r\n.subtitle {\r\n  font-size: 26rpx;\r\n  color: var(--text-muted);\r\n}\r\n\r\n.header-actions {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 16rpx;\r\n  align-items: center;\r\n}\r\n\r\n.header-btn {\r\n  padding: 16rpx 30rpx;\r\n  border-radius: 999rpx;\r\n  background: linear-gradient(135deg, rgba(59, 130, 246, 0.85), rgba(99, 102, 241, 0.8));\r\n  color: #05070f;\r\n  font-size: 26rpx;\r\n  font-weight: 600;\r\n  border: none;\r\n}\r\n\r\n.header-btn.ghost {\r\n  background: transparent;\r\n  border: 1rpx solid rgba(148, 163, 184, 0.4);\r\n  color: var(--text-primary);\r\n}\r\n\r\n.header-btn.danger {\r\n  background: transparent;\r\n  border: 1rpx solid rgba(239, 68, 68, 0.6);\r\n  color: rgba(248, 113, 113, 0.92);\r\n}\r\n\r\n.header-btn:disabled {\r\n  opacity: 0.65;\r\n}\r\n\r\n.chat-layout {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 24rpx;\r\n\r\n  @media (min-width: 1024px) {\r\n    flex-direction: row;\r\n    align-items: stretch;\r\n  }\r\n}\r\n\r\n.session-panel {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20rpx;\r\n  padding: 24rpx;\r\n}\r\n\r\n.session-header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n\r\n.session-title {\r\n  font-size: 30rpx;\r\n  font-weight: 600;\r\n}\r\n\r\n.session-counter {\r\n  font-size: 22rpx;\r\n  color: var(--text-muted);\r\n}\r\n\r\n.session-empty {\r\n  padding: 40rpx 12rpx;\r\n  text-align: center;\r\n  color: var(--text-muted);\r\n}\r\n\r\n.session-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12rpx;\r\n  max-height: 520rpx;\r\n}\r\n\r\n.session-item {\r\n  padding: 16rpx 20rpx;\r\n  border-radius: 16rpx;\r\n  background: var(--surface-light);\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8rpx;\r\n}\r\n\r\n.session-item.active {\r\n  border: 1rpx solid rgba(56, 189, 248, 0.45);\r\n  background: rgba(15, 23, 42, 0.65);\r\n}\r\n\r\n.session-title-row {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 12rpx;\r\n}\r\n\r\n.session-name {\r\n  font-size: 26rpx;\r\n  font-weight: 600;\r\n}\r\n\r\n.session-preview {\r\n  font-size: 22rpx;\r\n  color: var(--text-muted);\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n\r\n.session-time {\r\n  font-size: 20rpx;\r\n  color: var(--text-muted);\r\n}\r\n\r\n.session-unread {\r\n  min-width: 28rpx;\r\n  padding: 4rpx 10rpx;\r\n  border-radius: 999rpx;\r\n  background: rgba(56, 189, 248, 0.18);\r\n  color: #38bdf8;\r\n  font-size: 20rpx;\r\n  text-align: center;\r\n}\r\n\r\n.chat-panel {\r\n  flex: 2;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 28rpx;\r\n}\r\n\r\n.chat-empty {\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: rgba(148, 163, 184, 0.72);\r\n}\r\n\r\n.chat-body {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20rpx;\r\n  height: 100%;\r\n}\r\n\r\n.chat-meta {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n\r\n.chat-title {\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n}\r\n\r\n.chat-subtitle {\r\n  font-size: 24rpx;\r\n  color: var(--text-muted);\r\n}\r\n\r\n.chat-action {\r\n  padding: 10rpx 18rpx;\r\n  border-radius: 999rpx;\r\n  border: 1rpx solid rgba(56, 189, 248, 0.45);\r\n  background: transparent;\r\n  color: var(--text-muted);\r\n  font-size: 24rpx;\r\n}\r\n\r\n.message-list {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16rpx;\r\n  padding: 12rpx 6rpx;\r\n  max-height: 520rpx;\r\n}\r\n\r\n.message {\r\n  align-self: flex-start;\r\n  max-width: 85%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10rpx;\r\n  padding: 16rpx 20rpx;\r\n  border-radius: 16rpx;\r\n  background: var(--surface-light);\r\n}\r\n\r\n.message.system {\r\n  background: rgba(30, 41, 59, 0.65);\r\n}\r\n\r\n.message.self {\r\n  align-self: flex-end;\r\n  background: rgba(56, 189, 248, 0.18);\r\n}\r\n\r\n.message-content {\r\n  font-size: 26rpx;\r\n  color: var(--text-primary);\r\n  line-height: 1.6;\r\n}\r\n\r\n.message-image {\r\n  width: 100%;\r\n  max-width: 520rpx;\r\n  border-radius: 14rpx;\r\n  overflow: hidden;\r\n  border: 1rpx solid rgba(56, 189, 248, 0.25);\r\n}\r\n\r\n.message.self .message-image {\r\n  align-self: flex-end;\r\n}\r\n\r\n.message-caption {\r\n  font-size: 24rpx;\r\n  color: rgba(226, 232, 240, 0.92);\r\n  line-height: 1.5;\r\n}\r\n\r\n.message-time {\r\n  font-size: 20rpx;\r\n  color: rgba(148, 163, 184, 0.65);\r\n  align-self: flex-end;\r\n}\r\n\r\n.message-loading {\r\n  align-self: center;\r\n  font-size: 22rpx;\r\n  color: var(--text-muted);\r\n}\r\n\r\n.composer {\r\n  position: relative;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: stretch;\r\n  gap: 16rpx;\r\n  padding: 18rpx 20rpx;\r\n  border-radius: 22rpx;\r\n}\r\n\r\n.composer-toolbar {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 16rpx;\r\n}\r\n\r\n.tool-btn {\r\n  padding: 12rpx 22rpx;\r\n  border-radius: 12rpx;\r\n  background: rgba(15, 23, 42, 0.5);\r\n  border: 1rpx solid rgba(59, 130, 246, 0.35);\r\n  color: var(--text-primary);\r\n  font-size: 26rpx;\r\n}\r\n\r\n.tool-btn:disabled {\r\n  opacity: 0.5;\r\n}\r\n\r\n.composer-input {\r\n  width: 100%;\r\n  min-height: 140rpx;\r\n  font-size: 26rpx;\r\n  color: var(--text-primary);\r\n  padding: 16rpx 18rpx;\r\n  border-radius: 16rpx;\r\n  background: var(--surface-light);\r\n  border: 1rpx solid rgba(59, 130, 246, 0.2);\r\n}\r\n\r\n.composer-send {\r\n  align-self: flex-end;\r\n  padding: 16rpx 36rpx;\r\n  border-radius: 999rpx;\r\n  background: linear-gradient(135deg, rgba(59, 130, 246, 0.85), rgba(56, 189, 248, 0.85));\r\n  color: #05070f;\r\n  font-size: 26rpx;\r\n  font-weight: 600;\r\n  border: none;\r\n}\r\n\r\n.composer-send:disabled {\r\n  opacity: 0.5;\r\n}\r\n\r\n.emoji-panel {\r\n  position: absolute;\r\n  left: 20rpx;\r\n  right: 20rpx;\r\n  bottom: 120rpx;\r\n  padding: 18rpx 16rpx;\r\n  border-radius: 18rpx;\r\n  background: rgba(15, 23, 42, 0.95);\r\n  border: 1rpx solid rgba(56, 189, 248, 0.35);\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fill, minmax(60rpx, 1fr));\r\n  gap: 12rpx;\r\n  z-index: 5;\r\n}\r\n\r\n.emoji-item {\r\n  text-align: center;\r\n  font-size: 32rpx;\r\n  line-height: 1.6;\r\n}\r\n\r\n.group-modal {\r\n  position: fixed;\r\n  inset: 0;\r\n  background: rgba(2, 6, 23, 0.72);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 40rpx 28rpx;\r\n  z-index: 20;\r\n}\r\n\r\n.group-panel {\r\n  width: 100%;\r\n  max-width: 640rpx;\r\n  max-height: 80vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20rpx;\r\n  padding: 28rpx;\r\n}\r\n\r\n.group-header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n\r\n.group-title {\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n  color: var(--text-primary);\r\n}\r\n\r\n.group-close {\r\n  padding: 10rpx 24rpx;\r\n  border-radius: 999rpx;\r\n  border: 1rpx solid rgba(148, 163, 184, 0.35);\r\n  background: transparent;\r\n  color: var(--text-primary);\r\n  font-size: 24rpx;\r\n}\r\n\r\n.group-input,\r\n.group-textarea {\r\n  width: 100%;\r\n  padding: 16rpx 18rpx;\r\n  border-radius: 16rpx;\r\n  background: rgba(15, 23, 42, 0.5);\r\n  border: 1rpx solid rgba(59, 130, 246, 0.2);\r\n  color: var(--text-primary);\r\n  font-size: 26rpx;\r\n}\r\n\r\n.group-textarea {\r\n  min-height: 140rpx;\r\n}\r\n\r\n.group-list {\r\n  flex: 1;\r\n  max-height: 360rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12rpx;\r\n}\r\n\r\n.group-item {\r\n  padding: 16rpx 20rpx;\r\n  border-radius: 16rpx;\r\n  background: var(--surface-light);\r\n  border: 1rpx solid transparent;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 6rpx;\r\n}\r\n\r\n.group-item.selected {\r\n  border-color: rgba(56, 189, 248, 0.45);\r\n  background: rgba(15, 23, 42, 0.65);\r\n}\r\n\r\n.group-name {\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n  color: var(--text-primary);\r\n}\r\n\r\n.group-username {\r\n  font-size: 24rpx;\r\n  color: var(--text-muted);\r\n}\r\n\r\n.group-remark {\r\n  font-size: 22rpx;\r\n  color: rgba(148, 163, 184, 0.65);\r\n}\r\n\r\n.group-actions {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n}\r\n\r\n.group-btn {\r\n  padding: 16rpx 36rpx;\r\n  border-radius: 999rpx;\r\n  background: linear-gradient(135deg, rgba(59, 130, 246, 0.9), rgba(99, 102, 241, 0.85));\r\n  color: #05070f;\r\n  font-size: 26rpx;\r\n  font-weight: 600;\r\n  border: none;\r\n}\r\n\r\n.group-btn:disabled {\r\n  opacity: 0.5;\r\n}\r\n</style>","import MiniProgramPage from 'C:/Users/Administrator/source/repos/wwwskbjxyz/SPTEST-V1/SProtectAgentWeb.Api/wwwroot/uniapp/pages/chat/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["useAppStore","storeToRefs","computed","ref","onMounted","watch","nextTick","uni","downloadTextFile","base64"],"mappings":"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"}
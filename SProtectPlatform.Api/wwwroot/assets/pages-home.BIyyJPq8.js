import{d as s,u as a,D as e,z as n,A as t,o as i,c as l,w as c,a as d,b as o,l as u,B as r,F as g,n as f,m as _,i as b,f as h,e as p,S as m,j as y,t as k,s as w,_ as A}from"./index-HILlddLG.js";const v=A(s({__name:"home",setup(s){const A=a(),v=e();function C(){f({url:"/pages/agent/bind"})}function B(){_({url:"/pages/login/agent"})}return n((async()=>{if(!A.isAuthenticated)return;A.bindings.length||await A.fetchAgentProfile();const s=A.selectedBinding||A.bindings[0];s&&v.login({username:s.authorAccount,password:s.authorPassword}).catch((()=>{}))})),(s,a)=>{const e=b,n=h,f=p,_=m;return t(A).isAuthenticated?(i(),l(f,{key:0,class:"page"},{default:c((()=>[d(_,{"scroll-y":"",class:"content"},{default:c((()=>[d(f,{class:"section"},{default:c((()=>[d(f,{class:"section-header"},{default:c((()=>[d(e,{class:"section-title"},{default:c((()=>[o("已绑定的软件")])),_:1}),d(n,{class:"link",onClick:C},{default:c((()=>[o("绑定软件码")])),_:1})])),_:1}),d(f,{class:"binding-list"},{default:c((()=>[(i(!0),u(g,null,r(t(A).bindings,(s=>{var a;return i(),l(f,{key:s.bindingId,class:y(["binding-card",(null==(a=t(A).selectedBinding)?void 0:a.bindingId)===s.bindingId?"active":""]),onClick:a=>function(s){A.selectBinding(s),v.login({username:s.authorAccount,password:s.authorPassword}).then((()=>{w({title:"已切换 "+s.softwareCode,icon:"success"})})).catch((s=>{const a=(null==s?void 0:s.message)&&"string"==typeof s.message?s.message:"自动登录作者端失败，请手动登录";w({title:a,icon:"none"})}))}(s)},{default:c((()=>[d(f,{class:"binding-head"},{default:c((()=>[d(e,{class:"binding-code"},{default:c((()=>[o(k(s.authorDisplayName||"未命名软件"),1)])),_:2},1024),d(e,{class:"binding-type"},{default:c((()=>[o(k(s.softwareType),1)])),_:2},1024)])),_:2},1024),d(e,{class:"binding-meta"},{default:c((()=>[o("接口："+k(s.apiAddress)+":"+k(s.apiPort),1)])),_:2},1024),d(e,{class:"binding-meta"},{default:c((()=>[o("作者账号："+k(s.authorAccount),1)])),_:2},1024)])),_:2},1032,["class","onClick"])})),128))])),_:1})])),_:1})])),_:1})])),_:1})):(i(),l(f,{key:1,class:"empty"},{default:c((()=>[d(e,null,{default:c((()=>[o("请先登录代理账号。")])),_:1}),d(n,{class:"link",onClick:B},{default:c((()=>[o("前往登录")])),_:1})])),_:1}))}}}),[["__scopeId","data-v-0469eb47"]]);export{v as default};
